(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const g={},$=new Set,M=new Set;async function f(t){if(g[t])return g[t];const e=await fetch(t);if(!e.ok)throw new Error(`Erro ao carregar: ${t}`);const n=await e.text();return g[t]=n,n}async function A(t){const e=[];return t.querySelectorAll('link[rel="stylesheet"]').forEach(n=>{const a=n.href;if(!a||$.has(a))return;$.add(a);const r=n.cloneNode(!0);document.head.appendChild(r),e.push(new Promise(o=>{r.onload=o,r.onerror=o}))}),Promise.all(e)}function F(t){t.querySelectorAll("script").forEach(e=>{const n=e.src;if(n&&M.has(n)){e.remove();return}n&&M.add(n);const a=document.createElement("script");n?(a.src=n,a.type=e.type||"text/javascript",a.defer=!0):a.textContent=e.textContent,t.appendChild(a),e.remove()})}async function B(t,e,n){const a=document.createElement("div");a.innerHTML=e,await A(a);const r=a.querySelector("#children")||a;let o=t.querySelector("#children-wrapper");o||(o=document.createElement("div"),o.id="children-wrapper",t.appendChild(o));const i=document.createDocumentFragment();if(i.append(...r.childNodes),o.replaceChildren(i),F(o),typeof window.loadConstants=="function")try{window.loadConstants(o)}catch(c){console.warn("Erro em loadConstants:",c)}const s=a.querySelector("title")?.textContent;s&&(document.title=s);const d={};a.querySelectorAll("meta[name], meta[property]").forEach(c=>{const v=c.getAttribute("name")||c.getAttribute("property");v&&(d[v]=c.getAttribute("content"))}),document.dispatchEvent(new CustomEvent("spa:pageLoaded",{detail:{page:n,title:s,metas:d}}))}let R={fade:{enabled:!0,duration:250,useTranslate:!0,translateValue:"1px"}};function S(t,e=250){return new Promise(n=>{if(!t)return n();let a=!1;const r=setTimeout(()=>{a&&(a=!0,i(),n())},e+50);function o(s){s.target!==t||a||(a=!0,i(),n())}function i(){clearTimeout(r),t.removeEventListener("transitionend",o)}t.addEventListener("transitionend",o)})}const y=new WeakMap;async function q(t,e,n){const a=R.fade||{enabled:!1};if(!a.enabled||!t)return e();const r=a.duration,o=a.useTranslate?a.translateValue:null,i=y.get(t);i&&await i.catch(()=>{});const s=(async()=>{const d=t.style.transition;t.style.transition=`opacity ${r}ms ease, transform ${r}ms ease`,t.style.willChange="opacity, transform",t.style.opacity||(t.style.opacity=getComputedStyle(t).opacity||"1"),t.offsetWidth,t.style.opacity="0",o&&(t.style.transform=`translateY(${o})`),await S(t,r),await e(),t.offsetWidth,t.style.opacity="1",o&&(t.style.transform="translateY(0)"),await S(t,r),t.style.transition=d||""})();y.set(t,s);try{await s}finally{y.delete(t)}}const h=document.getElementById("route");async function L(t,e="Erro"){const n=l.error?.[t];if(!n){console.error(`gateway.error.${t} não configurado`),h.innerHTML=`<h1>${e}</h1>`,document.title=e;return}try{const a=await f(n.endsWith(".html")?n:`${n}.html`);h.innerHTML=a,document.title=e}catch(a){console.error(`Falha ao carregar gateway ${t}:`,a),h.innerHTML=`<h1>${e}</h1>`,document.title=e}}async function C(){let t=document.getElementById("pageLoad");t||(t=document.createElement("div"),t.id="pageLoad",Object.assign(t.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.85)",zIndex:"9999",color:"#fff"}),document.body.appendChild(t)),t.style.display="flex";try{const e=await f(l.load.pageLoad.endsWith(".html")?l.load.pageLoad:`${l.load.pageLoad}.html`);t.innerHTML=e}catch(e){console.error("Falha ao carregar pageLoad:",e),t.innerHTML="Carregando…"}}function u(){const t=document.getElementById("pageLoad");t&&(t.style.display="none",t.innerHTML="")}async function W(){history.pushState({},"","/404"),await L("error404","404 - Página não encontrada")}async function b(){history.pushState({},"","/500"),await L("error500","500 - Erro interno")}async function x(){history.pushState({},"","/offline"),await L("errorOffline","Sem conexão")}async function E(t){const e=l.flows.find(n=>n.path.test(t));if(e){await C();try{location.pathname!==t&&history.pushState({},"",t);const n=await f(e.page.endsWith(".html")?e.page:`${e.page}.html`);h.innerHTML=n,document.title=e.title||"Flow Page"}catch(n){console.error("Falha ao carregar flow:",n)}finally{u()}}}window.addEventListener("popstate",()=>{const t=location.pathname;l.flows.find(n=>n.path.test(t))?E(t):p(t)});const N=document.getElementById("route"),T=new Set;async function P(t){const e=document.querySelector("#children-wrapper");if(!e)return;const n=H.find(a=>a.path.test(t));if(!n){W();return}try{const a=await f(n.page.endsWith(".html")?n.page:`${n.page}.html`);await q(e,async()=>{await B(e,a,n.page)})}catch{navigator.onLine?b():x()}}async function O(t){if(!T.has(t))try{const e=await f(t.endsWith(".html")?t:`${t}.html`);N.innerHTML=e,T.add(t)}catch{b()}}async function p(t){t.startsWith("/")||(t=`/${t}`);const e=Date.now(),n=l.load.loadTime;if(l.flows.some(o=>o.path.test(t))){E(t);return}const a=w.find(o=>o.path.test(t)),r=H.find(o=>o.path.test(t));try{if(await C(),a){if(await O(a.page),m.useChildren){const s=t.split("/").filter(Boolean)[1]||m.defaultChild;await P(s)}const o=Date.now()-e;o<n&&await new Promise(i=>setTimeout(i,n-o)),u();return}if(r){const o=w.find(i=>i.path.test(`/${m.dirsChild}`))||w[1];await O(o.page),await P(t),u();return}u(),W()}catch{u(),navigator.onLine?b():x()}}function D(t){const e=t.target.closest("a");if(!e)return;const n=e.getAttribute("href");if(!n||n.startsWith("http")||n.startsWith("mailto:")||e.target==="_blank")return;t.preventDefault();const a=n.startsWith("/")?n:`/${n}`;if(l.flows.some(r=>r.path.test(a))){E(a);return}location.pathname!==a&&window.history.pushState({},"",a),p(a)}document.addEventListener("DOMContentLoaded",async()=>{document.body.addEventListener("click",D),window.addEventListener("popstate",()=>p(location.pathname)),await C(),await p(location.pathname),u()});function Y(t={}){const e={enabled:t.enabled??!0,up:t.up??null,down:t.down??null,left:t.left??null,right:t.right??null,threshold:t.threshold??50};if(!e.enabled)return;let n=0,a=0;function r(i){const s=i.touches[0];n=s.clientX,a=s.clientY}function o(i){const s=i.changedTouches[0],d=s.clientX-n,c=s.clientY-a;Math.abs(d)>Math.abs(c)&&Math.abs(d)>e.threshold?d>0&&e.right?location.hash=e.right:d<0&&e.left&&(location.hash=e.left):Math.abs(c)>Math.abs(d)&&Math.abs(c)>e.threshold&&(c>0&&e.down?location.hash=e.down:c<0&&e.up&&(location.hash=e.up))}document.addEventListener("touchstart",r,{passive:!0}),document.addEventListener("touchend",o,{passive:!0})}const I={scroll:{enabled:!0,mode:"smooth",custom:{ease:.4,stepMin:1,stepMax:60}},fade:{enabled:!0,duration:250,useTranslate:!1,translateValue:"1px"}},m={dirs:{layouts:"/components/layouts",models:"/components/models"},useChildren:!0,persistentChild:null,defaultChild:"/Init",dirsChild:"/app/Home/home"},l={error:{error404:"/app/pages/error/404",error500:"/app/pages/error/500",errorOffline:"/app/pages/error/offline"},load:{pageLoad:"/app/pages/loads/pageLoad",loading:"/app/pages/loads/loading",loadTime:1e3},flows:[{path:/^\/Politicas$/,page:"/app/pages/flows/politicas"},{path:/^\/Informacoes$/,page:"/app/pages/flows/informacoes"}]},w=[{path:/^\/$/,page:"/app/site/site"},{path:/^\/Home$/,page:m.dirsChild}],H=[{path:/^\/Init$/,page:"/app/routes/Init/init"},{path:/^\/Botoes$/,page:"/app/routes/Buttons/buttons"},{path:/^\/Fundos$/,page:"/app/routes/Background/background"},{path:/^\/Anotacoes$/,page:"/app/routes/Note/note"},{path:/^\/Sobre$/,page:"/app/routes/About/about"},{path:/^\/Contato$/,page:"/app/routes/Contact/contact"}];document.addEventListener("DOMContentLoaded",()=>{configureSheet(I),p(location.pathname||"/"),Y({enabled:!1,left:"/Botoes",right:"/Fundos",up:"/Sobre",down:"/Contato",threshold:40}),document.addEventListener("spa:pageLoaded",()=>{lazyLoadRoute(location.pathname)}),console.log("Main.js initialized: animated config",I)});
